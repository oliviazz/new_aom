"use client";import{enableVisualEditing as e}from"@sanity/visual-editing";import{useRouter as r,usePathname as t,useSearchParams as o}from"next/navigation.js";import{useRef as n,useState as s,useEffect as i}from"react";import{revalidateRootLayout as u}from"./actions.js";function a(a){const{refresh:c,zIndex:l}=a,d=r(),p=n(d),[v,h]=s();i((()=>{p.current=d}),[d]),i((()=>{const r=e({zIndex:l,refresh:c||(e=>{switch(e.source){case"manual":return e.livePreviewEnabled?(console.debug("Live preview is setup, calling router.refresh() to refresh the server components without refetching cached data"),p.current.refresh(),Promise.resolve()):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),u());case"mutation":return e.livePreviewEnabled?(console.debug("Live preview is setup, mutation is skipped assuming its handled by the live preview"),!1):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),u());default:throw new Error("Unknown refresh source",{cause:e})}}),history:{subscribe:e=>(h((()=>e)),()=>h(void 0)),update:e=>{switch(e.type){case"push":return p.current.push(e.url);case"pop":return p.current.back();case"replace":return p.current.replace(e.url);default:throw new Error(`Unknown update type: ${e.type}`)}}}});return()=>r()}),[c,l]);const m=t(),w=o();return i((()=>{v&&v({type:"push",url:`${m}${null!=w&&w.size?`?${w}`:""}`})}),[v,m,w]),null}export{a as default};//# sourceMappingURL=VisualEditing.js.map
