"use client";"use strict";var e=require("@sanity/visual-editing"),r=require("next/navigation.js"),t=require("react"),s=require("./actions.cjs");module.exports=function(u){const{refresh:i,zIndex:n}=u,o=r.useRouter(),a=t.useRef(o),[c,l]=t.useState();t.useEffect((()=>{a.current=o}),[o]),t.useEffect((()=>{const r=e.enableVisualEditing({zIndex:n,refresh:i||(e=>{switch(e.source){case"manual":return e.livePreviewEnabled?(console.debug("Live preview is setup, calling router.refresh() to refresh the server components without refetching cached data"),a.current.refresh(),Promise.resolve()):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),s.revalidateRootLayout());case"mutation":return e.livePreviewEnabled?(console.debug("Live preview is setup, mutation is skipped assuming its handled by the live preview"),!1):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),s.revalidateRootLayout());default:throw new Error("Unknown refresh source",{cause:e})}}),history:{subscribe:e=>(l((()=>e)),()=>l(void 0)),update:e=>{switch(e.type){case"push":return a.current.push(e.url);case"pop":return a.current.back();case"replace":return a.current.replace(e.url);default:throw new Error(`Unknown update type: ${e.type}`)}}}});return()=>r()}),[i,n]);const d=r.usePathname(),p=r.useSearchParams();return t.useEffect((()=>{c&&c({type:"push",url:`${d}${null!=p&&p.size?`?${p}`:""}`})}),[c,d,p]),null};//# sourceMappingURL=VisualEditing.cjs.map
