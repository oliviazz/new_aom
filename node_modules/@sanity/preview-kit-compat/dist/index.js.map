{"version":3,"file":"index.js","sources":["../../../node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/rng.js","../../../node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/stringify.js","../../../node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/native.js","../../../node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/v4.js","../../channels/src/constants.ts","../../channels/src/helpers.ts","../../channels/src/node.ts","../src/useDocumentsInUse.ts","../../visual-editing-helpers/dist/hooks.js"],"sourcesContent":["// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import type { ChannelMsgType } from './types'\n\nexport const RESPONSE_TIMEOUT = 1000\nexport const HEARTBEAT_INTERVAL = 1000\nexport const HANDSHAKE_INTERVAL = 500\n\nexport const INTERNAL_MSG_TYPES = [\n  'channel/disconnect',\n  'channel/response',\n  'channel/heartbeat',\n] satisfies ChannelMsgType[]\n\nexport const HANDSHAKE_MSG_TYPES = [\n  'handshake/syn',\n  'handshake/syn-ack',\n  'handshake/ack',\n] satisfies ChannelMsgType[]\n","import { HANDSHAKE_MSG_TYPES, INTERNAL_MSG_TYPES } from './constants'\nimport { ChannelMsgType, HandshakeMsgType, InternalMsgType } from './types'\n\nexport const isInternalMessage = (\n  type: ChannelMsgType | InternalMsgType,\n): type is InternalMsgType => {\n  return INTERNAL_MSG_TYPES.some((t) => t === type)\n}\n\nexport const isHandshakeMessage = (\n  type: ChannelMsgType | InternalMsgType,\n): type is HandshakeMsgType => {\n  return HANDSHAKE_MSG_TYPES.some((t) => t === type)\n}\n\nexport const isLegacyHandshakeMessage = ({\n  data = {},\n}: MessageEvent): boolean => {\n  return (\n    // Check data is a record type\n    typeof data === 'object' &&\n    data !== null &&\n    !Array.isArray(data) &&\n    // The \"domain\" key was introduced in commit 4854e7f\n    !('domain' in data) &&\n    // Check the rest of the object shape is present\n    ['id', 'type', 'from', 'to'].every((key) => key in data) &&\n    // Prior to 4854e7f only handshake events were emitted prior to an established connection\n    data.type.startsWith('handshake/')\n  )\n}\n","import { v4 as uuid } from 'uuid'\n\nimport {\n  isHandshakeMessage,\n  isInternalMessage,\n  isLegacyHandshakeMessage,\n} from './helpers'\nimport {\n  ChannelMsg,\n  ChannelsEventSubscriber,\n  ChannelsNode,\n  ChannelsNodeChannel,\n  ChannelsNodeOptions,\n  ChannelsNodeStatusSubscriber,\n  ChannelStatus,\n  HandshakeMsgType,\n  InternalMsgType,\n  ProtocolMsg,\n  ToArgs,\n} from './types'\n\nexport function createChannelsNode<\n  Sends extends ChannelMsg,\n  Receives extends ChannelMsg,\n>(config: ChannelsNodeOptions): ChannelsNode<Sends, Receives> {\n  const inFrame = window.self !== window.top || window.opener\n\n  const channel: ChannelsNodeChannel = {\n    buffer: [],\n    id: null,\n    origin: null,\n    source: null,\n    status: 'connecting',\n  }\n\n  function flush() {\n    const toFlush = [...channel.buffer]\n    channel.buffer.splice(0, channel.buffer.length)\n    toFlush.forEach(({ type, data }) => {\n      send(type, data)\n    })\n  }\n\n  function send<T extends Sends['type']>(\n    type: T | InternalMsgType | HandshakeMsgType,\n    data?: Extract<Sends, { type: T }>['data'],\n  ) {\n    if (\n      !isHandshakeMessage(type) &&\n      !isInternalMessage(type) &&\n      (channel.status === 'connecting' || channel.status === 'reconnecting')\n    ) {\n      channel.buffer.push({ type, data })\n      return\n    }\n\n    if (channel.id && channel.origin && channel.source) {\n      const msg: ProtocolMsg<Sends> = {\n        connectionId: channel.id,\n        data,\n        domain: 'sanity/channels',\n        from: config.id,\n        id: uuid(),\n        to: config.connectTo,\n        type,\n      }\n\n      try {\n        channel.source.postMessage(msg, {\n          targetOrigin: channel.origin,\n        })\n      } catch (e) {\n        throw new Error(`Failed to postMessage '${msg.id}' on '${config.id}'`)\n      }\n    }\n  }\n\n  function isValidMessageEvent(\n    e: MessageEvent,\n  ): e is MessageEvent<ProtocolMsg<Receives>> {\n    const { data } = e\n    return (\n      data.domain === 'sanity/channels' &&\n      data.to === config.id &&\n      data.from === config.connectTo &&\n      data.type !== 'channel/response'\n    )\n  }\n\n  function handleEvents(e: MessageEvent) {\n    if (isLegacyHandshakeMessage(e)) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Visual editing package mismatch detected! Please ensure you are using the latest version of Sanity Studio and any packages listed here:\\nhttps://github.com/sanity-io/visual-editing',\n      )\n      return\n    }\n\n    if (isValidMessageEvent(e)) {\n      const { data } = e\n      // Once we know the origin, after a valid handshake, we always verify it\n      if (channel.origin && e.origin !== channel.origin) {\n        return\n      }\n      // Always update the channel source reference, in case it changes\n      if (e.source && channel.source !== e.source) {\n        channel.source = e.source\n      }\n\n      if (isHandshakeMessage(data.type) && data.data) {\n        if (data.type === 'handshake/syn') {\n          channel.origin = e.origin\n          channel.id = data.data.id as string\n          setConnectionStatus('connecting')\n          send('handshake/syn-ack', { id: channel.id })\n          return\n        }\n        if (data.type === 'handshake/ack' && data.data.id === channel.id) {\n          setConnectionStatus('connected')\n          return\n        }\n      } else if (\n        data.connectionId === channel.id &&\n        e.origin === channel.origin\n      ) {\n        if (data.type === 'channel/disconnect') {\n          setConnectionStatus('disconnected')\n          return\n        } else {\n          const args = [data.type, data.data] as ToArgs<Receives>\n          eventSubscribers.forEach((subscriber) => {\n            subscriber(...args)\n          })\n          send('channel/response', { responseTo: data.id })\n        }\n        return\n      }\n    }\n  }\n\n  const eventSubscribers = new Set<ChannelsEventSubscriber<Receives>>()\n\n  function subscribeToEvent(subscriber: ChannelsEventSubscriber<Receives>) {\n    eventSubscribers.add(subscriber)\n    return () => eventSubscribers.delete(subscriber)\n  }\n\n  function disconnect() {\n    if (['disconnected'].includes(channel.status)) return\n    // send('channel/disconnect', { id: channel.id })\n    setConnectionStatus('disconnected')\n  }\n\n  const statusSubscribers = new Set<ChannelsNodeStatusSubscriber>()\n\n  function subscribeToStatus(subscriber: ChannelsNodeStatusSubscriber) {\n    statusSubscribers.add(subscriber)\n    return () => statusSubscribers.delete(subscriber)\n  }\n\n  function setConnectionStatus(next: ChannelStatus) {\n    channel.status = next\n    statusSubscribers.forEach((subscriber) => {\n      subscriber(next)\n    })\n    if (next === 'connected') {\n      flush()\n    }\n  }\n\n  function destroy() {\n    disconnect()\n    eventSubscribers.clear()\n    statusSubscribers.clear()\n    window.removeEventListener('message', handleEvents, false)\n  }\n\n  function initialise() {\n    window.addEventListener('message', handleEvents, false)\n    setConnectionStatus('connecting')\n  }\n\n  initialise()\n\n  function sendPublic<T extends Sends['type']>(\n    type: T,\n    data?: Extract<Sends, { type: T }>['data'],\n  ) {\n    send(type, data)\n  }\n\n  return {\n    destroy,\n    inFrame,\n    send: sendPublic,\n    subscribe: subscribeToEvent,\n    onStatusUpdate: subscribeToStatus,\n  }\n}\n","import { type ChannelsNode, createChannelsNode } from '@sanity/channels'\nimport type { ContentSourceMapDocuments } from '@sanity/client/csm'\nimport {\n  type PresentationMsg,\n  type PreviewKitMsg,\n  type VisualEditingConnectionIds,\n} from '@sanity/visual-editing-helpers'\nimport { useEffect, useState } from 'react'\n\n/**\n * Reports the documents in use on the page to the Presentation Tool, if a connection can be established.\n * @internal\n */\nexport function useDocumentsInUse(\n  documentsInUse: Map<string, ContentSourceMapDocuments[number]>,\n  projectId: string,\n  dataset: string,\n): void {\n  const [channel, setChannel] = useState<\n    ChannelsNode<PreviewKitMsg, PresentationMsg> | undefined\n  >()\n  const [connected, setConnected] = useState(false)\n  useEffect(() => {\n    if (window.self === window.top && !window.opener) {\n      return\n    }\n    const channel = createChannelsNode<PreviewKitMsg, PresentationMsg>({\n      id: 'preview-kit' satisfies VisualEditingConnectionIds,\n      connectTo: 'presentation' satisfies VisualEditingConnectionIds,\n    })\n\n    channel.onStatusUpdate((status) => {\n      if (status === 'connected') {\n        setConnected(true)\n      } else if (status === 'disconnected') {\n        setConnected(false)\n      }\n    })\n\n    const timeout = setTimeout(() => setChannel(channel), 0)\n    return () => {\n      clearTimeout(timeout)\n      channel.destroy()\n      setChannel(undefined)\n    }\n  }, [dataset, projectId])\n\n  const changedKeys = JSON.stringify(Array.from(documentsInUse.keys()))\n  useEffect(() => {\n    if (changedKeys !== '[]' && channel && connected) {\n      channel.send('preview-kit/documents', {\n        projectId,\n        dataset,\n        perspective: 'previewDrafts',\n        documents: Array.from(documentsInUse.values()),\n      })\n    }\n  }, [changedKeys, channel, connected, dataset, documentsInUse, projectId])\n}\n","import{useMemo as e,useState as n,useCallback as t,useEffect as i,useSyncExternalStore as r}from\"react\";function o(n){const t=e((()=>JSON.stringify(n||{})),[n]);return e((()=>JSON.parse(t)),[t])}function s(e){const{refreshInterval:o}=e,s=function(){const[e,t]=n(!1);i((()=>{t(navigator.onLine);const e=()=>t(!0),n=()=>t(!1);return window.addEventListener(\"online\",e),window.addEventListener(\"offline\",n),()=>{window.removeEventListener(\"online\",e),window.removeEventListener(\"offline\",n)}}),[]);const o=r(d,(()=>document.visibilityState),(()=>\"hidden\"));return!e||\"hidden\"===o}(),[c,u]=n(\"hit\"),a=t((()=>(u(\"inflight\"),()=>u(\"hit\"))),[]);return i((()=>{if(!o||\"hit\"!==c)return;const e=setTimeout((()=>u(\"stale\")),o);return()=>clearTimeout(e)}),[o,c]),i((()=>{if(\"hit\"!==c)return;const e=()=>u(\"stale\");return window.addEventListener(\"focus\",e),()=>window.removeEventListener(\"focus\",e)}),[o,c]),i((()=>{s&&\"hit\"===c&&u(\"stale\"),!s&&\"stale\"===c&&u(\"refresh\")}),[s,c]),[c,a]}function d(e){return document.addEventListener(\"visibilitychange\",e),()=>document.removeEventListener(\"visibilitychange\",e)}export{o as useQueryParams,s as useRevalidate};//# sourceMappingURL=hooks.js.map\n"],"names":["useState","useEffect","useMemo","useSyncExternalStore","useCallback","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","Error","byteToHex","i","push","toString","slice","native","randomUUID","v4","options","buf","offset","rnds","random","arr","unsafeStringify","INTERNAL_MSG_TYPES","HANDSHAKE_MSG_TYPES","isInternalMessage","type","some","t","isHandshakeMessage","isLegacyHandshakeMessage","data","Array","isArray","every","key","startsWith","createChannelsNode","config","inFrame","window","self","top","opener","channel","buffer","id","origin","source","status","send","msg","connectionId","domain","from","uuid","to","connectTo","postMessage","targetOrigin","handleEvents","e","console","error","isValidMessageEvent","setConnectionStatus","args","eventSubscribers","forEach","subscriber","responseTo","Set","statusSubscribers","next","toFlush","splice","length","flush","addEventListener","destroy","includes","clear","removeEventListener","subscribe","add","delete","onStatusUpdate","useDocumentsInUse","documentsInUse","projectId","dataset","setChannel","connected","setConnected","channel2","timeout","setTimeout","clearTimeout","changedKeys","JSON","stringify","keys","perspective","documents","values","o","n","parse","s","refreshInterval","navigator","onLine","r","d","document","visibilityState","c","u","a","s2"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}